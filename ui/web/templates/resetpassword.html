<!-- Copyright (c) Abstract Machines
SPDX-License-Identifier: Apache-2.0 -->

{{ define "resetPassword" }}
  <!doctype html>
  <html lang="en">
    <head>
      <title>Password Reset</title>
      {{ template "header" }}
    </head>
    <body class="login-body">
      <div class="container-fluid mt-5 pt-5">
        <div class="row p-5">
          <div class="login-card col-lg-4 col-xxl-3 p-md-5 mx-auto mt-5">
            <div class="row text-center mb-4 d-flex flex-column align-items-center">
              <div class="mb-3 border-bottom pb-3">
                <div class="sidebar-brand d-flex justify-content-center mt-2">
                  <h1 class="mx-3">Magistrala</h1>
                </div>
              </div>
              <div class="login-header mb-4">
                <h2>Reset Password</h2>
              </div>
              <form
                method="post"
                id="form"
                class="row border-bottom pb-3 mb-3"
                onsubmit="return validateForm()"
              >
                <div class="col-md-12">
                  <div class="row mb-3">
                    <div class="col-md-12 input-field">
                      <i class="fas fa-solid fa-lock me-2"></i>
                      <input
                        class="p-3 w-100 me-2"
                        type="password"
                        name="password"
                        id="password"
                        placeholder="Password"
                        required
                      />
                      <span class="password-toggle-icon"><i class="fas fa-eye"></i></span>
                      <div id="passwordError" class="text-danger"></div>
                    </div>
                  </div>
                  <div class="row mb-3">
                    <div class="col-md-12 input-field">
                      <i class="fas fa-solid fa-lock me-2"></i>
                      <input
                        class="p-3 w-100 me-2"
                        type="password"
                        name="confirmPassword"
                        id="confirmPassword"
                        placeholder="confirm Password"
                        required
                      />
                      <span class="password-toggle-icon"><i class="fas fa-eye"></i></span>
                      <div id="confirmPasswordError" class="text-danger"></div>
                    </div>
                  </div>
                </div>
                <div class="col-md-12 d-grid py-3">
                  <button type="submit" class="login-btn py-3">Reset Password</button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
      <script>
        function validateForm() {
          var password = document.getElementById("password").value;
          var confirmPassword = document.getElementById("confirmPassword").value;

          var passwordError = document.getElementById("passwordError");
          var confirmPasswordError = document.getElementById("confirmPasswordError");

          passwordError.innerHTML = "";
          confirmPasswordError.innerHTML = "";
          var isValid = true;

          if (password.length < 8) {
            passwordError.innerHTML = "Password must have a minimum of 8 characters!";
            isValid = false;
          }
          if (confirmPassword != password) {
            confirmPasswordError.innerHTML = "Passwords do not match!";
            isValid = false;
          }
          return isValid;
        }
        //Code for toggling the visibility of the password
        const togglePassword = document.querySelectorAll(".password-toggle-icon i");
        togglePassword.forEach((icon) => {
          icon.addEventListener("click", function () {
            const passwordField = icon.parentElement.previousElementSibling;
            if (passwordField.type === "password") {
              passwordField.type = "text";
              icon.classList.remove("fa-eye");
              icon.classList.add("fa-eye-slash");
            } else {
              passwordField.type = "password";
              icon.classList.remove("fa-eye-slash");
              icon.classList.add("fa-eye");
            }
          });
        });
      </script>
    </body>
  </html>
{{ end }}
